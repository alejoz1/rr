<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificador Round Robin</title>
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiUGxhbmlmaWNhZG9yIFJvdW5kIFJvYmluIiwic2hvcnRfbmFtZSI6IlJSIFBsYW5uZXIiLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2ZmZmZmZiIsInRoZW1lX2NvbG9yIjoiIzIxOTZGMyIsImljb25zIjpbeyJzcmMiOiJodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMTkyeDE5Mi5wbmciLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2UvcG5nIn1dfQ==">
    <style>
        /* ... (estilos anteriores) ... */
        .timeline {
            display: flex;
            overflow-x: auto;
            margin-top: 20px;
            padding: 10px 0;
            background-color: #f0f0f0;
        }
        .timeline-block {
            flex: 0 0 auto;
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ... (contenido HTML anterior) ... -->
        <div class="timeline" id="timeline"></div>
    </div>

    <script>
        let processes = [
            { id: 1, burstTime: 10, remainingTime: 10, color: '#FF9800' },
            { id: 2, burstTime: 5, remainingTime: 5, color: '#4CAF50' },
            { id: 3, burstTime: 8, remainingTime: 8, color: '#2196F3' },
        ];
        let timeQuantum = 2;
        let currentTime = 0;
        let currentProcessIndex = 0;
        let intervalId;
        let timeline = [];

        function updateTable() {
            // ... (código anterior de updateTable) ...
        }

        function updateTimeQuantum() {
            timeQuantum = parseInt(document.getElementById('timeQuantum').value);
        }

        function runSimulation() {
            if (processes.every(p => p.remainingTime === 0)) {
                stopSimulation();
                return;
            }

            currentTime++;
            document.getElementById('currentTime').textContent = currentTime;

            let currentProcess = processes[currentProcessIndex];
            if (currentProcess.remainingTime > 0) {
                currentProcess.remainingTime--;
                document.getElementById('currentProcess').textContent = currentProcess.id;
                timeline.push(currentProcess.id);
                updateTimeline();
            }

            if (currentProcess.remainingTime === 0 || currentTime % timeQuantum === 0) {
                do {
                    currentProcessIndex = (currentProcessIndex + 1) % processes.length;
                } while (processes[currentProcessIndex].remainingTime === 0 && processes.some(p => p.remainingTime > 0));
            }

            updateTable();
        }

        function updateTimeline() {
            const timelineElement = document.getElementById('timeline');
            timelineElement.innerHTML = '';
            timeline.forEach((processId, index) => {
                const block = document.createElement('div');
                block.className = 'timeline-block';
                block.style.backgroundColor = processes.find(p => p.id === processId).color;
                block.textContent = processId;
                block.title = `Tiempo ${index + 1}: Proceso ${processId}`;
                timelineElement.appendChild(block);
            });
        }

        function startSimulation() {
            if (!intervalId) {
                intervalId = setInterval(runSimulation, 1000);
            }
        }

        function stopSimulation() {
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }
        }

        function addNewProcess() {
            const burstTime = parseInt(document.getElementById('newProcessBurst').value);
            if (burstTime > 0) {
                const newId = processes.length > 0 ? Math.max(...processes.map(p => p.id)) + 1 : 1;
                const colors = ['#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#00BCD4', '#009688', '#FFEB3B', '#FF5722'];
                const newColor = colors[processes.length % colors.length];
                processes.push({ id: newId, burstTime: burstTime, remainingTime: burstTime, color: newColor });
                updateTable();
                document.getElementById('newProcessBurst').value = '';
            }
        }

        updateTable();

        // ... (código del Service Worker) ...
    </script>
</body>
</html>
</body>
</html>
